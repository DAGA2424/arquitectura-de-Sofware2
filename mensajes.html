<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Portafolio ‚Äî Mensajes</title>
<style>
*{box-sizing:border-box;margin:0;padding:0;}
body{font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial;background:#000;color:#f1f5f9;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}
header{position:sticky;top:0;background:linear-gradient(90deg,#0f172a,#1f2937);color:white;padding:12px 18px;display:flex;align-items:center;justify-content:space-between;gap:12px;z-index:999;box-shadow:0 2px 8px rgba(0,0,0,0.25);}
.brand{display:flex;gap:12px;align-items:center;}
.brand img{width:48px;height:48px;border-radius:50%;object-fit:cover;}
.brand .title{font-weight:700;font-size:18px;}
.brand .subtitle{font-size:13px;color:#cbd5e1;}
nav a{color:white;text-decoration:none;margin-left:15px;font-weight:500;}
nav a:hover{text-decoration:underline;}
main{max-width:900px;margin:28px auto;padding:0 16px;}
.panel{background:#0f172a;padding:20px;border-radius:12px;border:1px solid #334155;color:#e2e8f0;}
h1{font-size:22px;color:#38bdf8;margin-bottom:16px;}
.counter{font-size:15px;color:#cbd5e1;margin-bottom:12px;}
.msg-list{display:flex;flex-direction:column;gap:14px;}
.msg-item{background:#071826;border:1px solid #233241;padding:14px;border-radius:10px;position:relative;}
.msg-item .from{font-weight:600;color:#38bdf8;margin-bottom:6px;}
.msg-item .email{font-size:13px;color:#94a3b8;margin-bottom:6px;}
.msg-item .text{margin-bottom:6px;}
.msg-item .date{font-size:12px;color:#9ca3af;}
.delete-btn{position:absolute;top:10px;right:10px;background:#ef4444;color:#fff;border:none;border-radius:6px;padding:4px 8px;cursor:pointer;font-size:12px;}
.delete-btn:hover{background:#dc2626;}
.notice{font-size:14px;color:#94a3b8;background:rgba(255,255,255,0.02);padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.05);}
button{background:#06b6d4;color:#042027;padding:10px 16px;border:none;border-radius:8px;cursor:pointer;font-weight:600;}
button:hover{opacity:0.9;}
.actions{margin-top:16px;display:flex;gap:12px;}
#clearBtn{background:#dc2626;color:#fff;}
#clearBtn:hover{background:#b91c1c;}
</style>
</head>
<body>
<header>
  <div class="brand">
    <img src="img/logo.png" alt="Logo">
    <div>
      <div class="title">DAGA</div>
      <div class="subtitle">Portafolio Cursos</div>
    </div>
  </div>
  <nav>
    <a href="index.html">Inicio</a>
    <a href="cursos.html">Cursos</a>
    <a href="contacto.html">Contacto</a>
    <a href="mensajes.html">Mensajes</a>
  </nav>
</header>

<main>
  <section class="panel">
    <h1>Mensajes recibidos</h1>
    <div id="counter" class="counter"></div>
    <div id="content"></div>
    <div class="actions" id="actions" style="display:none;">
      <button id="clearBtn">üóëÔ∏è Eliminar todos los mensajes</button>
    </div>
  </section>
</main>

<script>
function renderMensajes(){
  const logged = localStorage.getItem("logged");
  const content = document.getElementById("content");
  const actions = document.getElementById("actions");
  const counter = document.getElementById("counter");

  // Solo mostrar si est√° logeado como admin
  if(logged !== "DAGA"){
    counter.innerHTML = "";
    content.innerHTML = `
      <div class="notice">
        ‚ö†Ô∏è Debes iniciar sesi√≥n para ver los mensajes.
      </div>
      <div style="margin-top:12px;">
        <a href="index.html"><button>Volver al inicio</button></a>
      </div>
    `;
    actions.style.display = "none";
    return;
  }

  const stored = JSON.parse(localStorage.getItem("messages") || "[]");
  if(stored.length === 0){
    counter.innerHTML = "üì≠ No tienes mensajes.";
    content.innerHTML = `<div class="notice">No hay mensajes enviados a√∫n.</div>`;
    actions.style.display = "none";
    return;
  }

  counter.innerHTML = `üì© Tienes <b>${stored.length}</b> mensaje${stored.length > 1 ? "s" : ""}.`;

  let html = '<div class="msg-list">';
  stored.forEach((msg, index)=>{
    html += `
      <div class="msg-item">
        <button class="delete-btn" onclick="deleteMensaje(${index})">Eliminar</button>
        <div class="from">üë§ ${msg.name}</div>
        <div class="email">üìß ${msg.email}</div>
        <div class="text">${msg.message}</div>
        <div class="date">üïí ${new Date(msg.created).toLocaleString()}</div>
      </div>
    `;
  });
  html += '</div>';
  content.innerHTML = html;
  actions.style.display = "flex";
}

function deleteMensaje(index){
  const stored = JSON.parse(localStorage.getItem("messages") || "[]");
  stored.splice(index, 1);
  localStorage.setItem("messages", JSON.stringify(stored));
  renderMensajes();
}

// Bot√≥n para eliminar todos
document.getElementById("clearBtn").addEventListener("click", ()=>{
  if(confirm("¬øSeguro que quieres eliminar todos los mensajes?")){
    localStorage.removeItem("messages");
    renderMensajes();
    alert("Mensajes eliminados correctamente.");
  }
});

// Inicializar al cargar
window.addEventListener("load", renderMensajes);
</script>
</body>
</html>